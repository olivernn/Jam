/*  Jam JavaScript Widget library, version 0.0.1
 *  (c) 2010 Oliver Nightingale
 *
 *  Released under MIT license.
 */
var GridView=function(a,b,c){c=c||{};a=function(d){this.collection=d||[];this.pagesRequired=Math.ceil(this.collection.length/this.perPage);this.template=$(this.templateSelector);this.holder=$(this.holderSelector);this.html=this.template.clone();this.viewPort=this.html.find(".view-port");this.pageTemplate=$('<ul class="grid-page clearfix"></ul>');this.pageHolder=this.html.find(".page-holder");this.page=1};$.extend(a.prototype,GridView.InstanceMethods,c,b);return a};
GridView.InstanceMethods={gridItemHTML:function(){console.log("you should overwrite this method and return HTML")},backHref:function(){return this.canPageBack()?this.pageNumHref(this.prevPageNum()):"#"},canPageBack:function(){return this.page>1},canPageForward:function(){return this.page!=this.pagesRequired},collectionEndIndex:function(){return this.page*this.perPage},collectionStartIndex:function(){return(this.page-1)*this.perPage},draw:function(a){this.holder.empty();if(this.collection.length!=
0){for(;this.pagesRequired>=this.page;){this.drawPage();this.page++}this.page=a||1;this.drawPaginationControls();this.holder.append(this.html)}else this.drawBlankState()},drawBlankState:function(){console.log("You should overwrite this method")},drawPage:function(){var a=this,b=this.pageTemplate.clone();b.attr("id","page-"+this.page);$.each(this.collection.slice(this.collectionStartIndex(),this.collectionEndIndex()),function(){b.append(a.gridItemHTML(this))});this.pageHolder.append(b)},drawPaginationControls:function(){var a=
this;this.viewPort.find(".back").attr("href",this.backHref());this.viewPort.find(".forward").attr("href",this.forwardHref());this.viewPort.find("a.page-link").remove();$.each(_.range(this.pagesRequired).reverse(),function(){var b=$('<a class="page-link button"></a>');b.attr("href",a.pageNumHref(this+1)).text(this+1);this+1==a.page&&b.addClass("current");a.viewPort.find(".pages-link").after(b)})},forwardHref:function(){return this.canPageForward()?this.pageNumHref(this.nextPageNum()):"#"},needsMoreItems:function(){return this.page>=
this.pagesRequired-1},nextPageNum:function(){return parseInt(this.page)+1},pagePosition:function(a){return-1*(a-1)*this.pageWidth+"px"},pageNumHref:function(a){return this.paginationUrl+a},prevPageNum:function(){return parseInt(this.page)-1},showPage:function(a){this.page=a;this.pageHolder.animate({left:this.pagePosition(a)},800);this.drawPaginationControls();this.needsMoreItems()&&this.holder.trigger("itemsNeeded.grid")}};
